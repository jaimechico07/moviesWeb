<header class="fixed w-full z-50 bg-[#212529]/40 p-4">
  <nav class="max-w-7xl hidden lg:block mx-auto relative">
    <div
      *ngIf="auth.user$ | async as user"
      class="flex justify-between items-center"
    >
      <figure>
        <img
          class="w-60 cursor-pointer"
          src="../../../assets/yokaifilm-white.webp"
          alt="logo yokaifilm"
        />
      </figure>
      <ul class="flex items-center text-white gap-x-5">
        <li routerLink="/explore" class="cursor-pointer">Movies</li>
        <li class="cursor-pointer">TV Shows</li>
        <li
          (click)="toggleSearchVisibility()"
          class="flex items-center cursor-pointer"
        >
          <i-tabler name="search"></i-tabler>
        </li>
        <li
          (click)="toggleProfileVisibility()"
          class="w-10 h-10 rounded-full cursor-pointer"
        >
          <img
            class="w-full h-full rounded-full mb-2"
            [src]="user.picture"
            alt=""
          />
          <div
            class="absolute bg-white w-auto right-0 rounded-xl text-black p-4 z-20"
            [ngClass]="{ hidden: !isProfileVisible, block: isProfileVisible }"
          >
            <ul class="flex flex-col gap-4">
              <li class="font-bold">{{ user.name }}</li>
              <li (click)="logout()">LogOut</li>
            </ul>
          </div>
        </li>
      </ul>
    </div>

    <div
      class="absolute px-8 top-28 w-full transition-all duration-500 ease-out transform opacity-0 translate-y-5 scale-95 pointer-events-none"
      [ngClass]="{
        'opacity-100 translate-y-0 scale-100 pointer-events-auto':
          isSearchVisible
      }"
    >
      <input
        class="w-full outline-none rounded-full px-3 py-2"
        type="search"
        placeholder="Search Movie"
      />
    </div>
  </nav>

  <!-- Mobile -->
  <nav class="block mx-auto lg:hidden relative">
    <div class="flex justify-between" *ngIf="auth.user$ | async as user">
      <div
        class="bg-red-600 cursor-pointer flex items-center px-3 py-2 rounded-md mb-2"
        (click)="toggleMenuVisibility()"
      >
        <i-tabler class="text-white" name="menu-2"></i-tabler>
      </div>
      <ul class="flex items-center text-white gap-x-5">
        <li
          (click)="toggleSearchVisibility()"
          class="flex items-center cursor-pointer"
        >
          <i-tabler name="search"></i-tabler>
        </li>
        <li
          (click)="toggleProfileVisibility()"
          class="w-10 h-10 rounded-full cursor-pointer"
        >
          <img
            class="w-full h-full rounded-full mb-2"
            [src]="user.picture"
            alt=""
          />
          <div
            class="absolute bg-white w-auto right-0 rounded-xl text-black shadow-md z-20"
            [ngStyle]="{
              transition: 'max-height 0.5s ease-in-out',
              'max-height': isProfileVisible ? '200px' : '0'
            }"
          >
            <ul
              class="flex flex-col divide-y overflow-hidden"
              [ngStyle]="{
                transition:
                  'max-height 0.5s ease-in-out, opacity 0.3s ease-in-out',
                'max-height': isProfileVisible ? '200px' : '0',
                opacity: isProfileVisible ? '1' : '0'
              }"
            >
              <li class="px-4 py-2 cursor-pointer font-semibold">
                {{ user.name }}
              </li>
              <li
                class="px-4 py-2 cursor-pointer font-semibold"
                (click)="logout()"
              >
                LogOut
              </li>
            </ul>
          </div>
        </li>
      </ul>
    </div>
    <div
      class="absolute w-full bg-white"
      [ngStyle]="{
        transition: 'max-height 0.5s ease-in-out',
        'max-height': isMenuVisible ? '200px' : '0'
      }"
    >
      <ul
        class="flex flex-col divide-y overflow-hidden"
        [ngStyle]="{
          transition: 'max-height 0.5s ease-in-out, opacity 0.3s ease-in-out',
          'max-height': isMenuVisible ? '200px' : '0',
          opacity: isMenuVisible ? '1' : '0'
        }"
      >
        <li class="px-4 py-2 cursor-pointer font-semibold">Home</li>
        <li class="px-4 py-2 cursor-pointer font-semibold">Movies</li>
        <li class="px-4 py-2 cursor-pointer font-semibold">Tv Shows</li>
      </ul>
    </div>

    <div
      class="absolute px-8 top-28 w-full transition-all duration-500 ease-out transform opacity-0 translate-y-5 scale-95 pointer-events-none"
      [ngClass]="{
        'opacity-100 translate-y-0 scale-100 pointer-events-auto':
          isSearchVisible
      }"
    >
      <input
        class="w-full outline-none rounded-full px-3 py-2"
        type="search"
        placeholder="Search Movie"
      />
    </div>
  </nav>
</header>
